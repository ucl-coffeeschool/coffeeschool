<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Lesson 2 - Coffee School</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/3.0.3/normalize.css" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link href="css/main.css" rel="stylesheet">
    <link href="css/prism.css" rel="stylesheet">
    <script src="js/prism.js" type="text/javascript" charset="utf-8"></script>
</head>

<body>
    <!-- nav stuff. -->
    <nav>
        <a href="index.html">Home</a>
        <a href="sections.html" class="active">Sections</a>
        <a href="about.html">About</a>
    </nav>

    <div class="nagbar" style="display:none">
        <p>Your code doesn't seem to do what we're looking for. Check it and try again!</p>
        <i class="fa fa-close"></i>
    </div>

    <!-- Main content. -->
    <div class="overlay" style="display:none">
        <span class="closeButton"><i class="fa fa-close"></i></span>
            <h1>Lesson completed!</h1>
            <h2>Give yourself a pat on the back.</h2>
            <a href="section-Using Game States-lesson-part1-3.html">Next lesson!</a>
    </div>
    <div class="main">
        <header>
            <div id="menu-button"><i class="fa fa-bars"></i></div>
            <h1>Coffee School <i class="fa fa-code"></i><em>Game Lesson Three - Using Game States</em></h1>
        </header>
        <div class="container">
            <div class="flex-container div-half">
                <h2>Code Editor <button id="code-compile"><i class="fa fa-play"></i> Update</button><span id="syntax-msg"></span>
                        <button id="nextLesson" onClick="window.location = 'section-Using Game States-lesson-part1-3.html'"><i class="fa fa-arrow-right"></i> Next Lesson</button>
                        </h2>

                <div id="codeEditor">// Creating environment variables
var playerSize = 10;
var sceneWidth = 300, sceneHeight = 150;
var groundHeight = 10;
var playAreaHeight = (sceneHeight - groundHeight);
// Create the variables to track player movement
var playerVel = 0; // Stores the player&#x27;s velocity
var g = 0.4;       // The constant acceleration cause by &quot;gravity&quot;
// Object width!
var objectWidth = 2 * playerSize;
// Obstacle Counter
var obstacleCounter = 0;

// Sets the background colour
Crafty.background(&quot;#ADD8E6&quot;);

// Create the ground!
Crafty.e(&quot;Solid, 2D, DOM, Color&quot;)
    .attr({x: 0,
           y: playAreaHeight,
           w: sceneWidth,
           h: groundHeight})
    .color(&quot;#00ff00&quot;);

// Create our player&#x27;s base entity
Crafty.e(&quot;Collision, 2D, DOM, Color&quot;) // Specifying the components to add
    .attr({x: 30, y: 30, w: playerSize, h: playerSize}) // Specifying the dimensions and the point to draw from
    .checkHits(&quot;Solid&quot;)
    .color(&quot;#ff0000&quot;) // Specifying the colour of the rectangle
    .bind(&quot;EnterFrame&quot;, function() { // Binds the &quot;EnterFrame&quot; event to the entity
        if(this.y &lt; 0) {
          playerVel = g; // Prevent the player from going above the game screen
        }
        else {
          playerVel += g; // Adds the &quot;gravitational acceleration&quot; to the player&#x27;s velocity
        }

        this.y += playerVel; // Change the player entities y position based on the player velocity
    })
    .bind(&quot;KeyDown&quot;, function(event) { // Binds the &quot;KeyDown&quot; event to our player entity
        if(event.key == Crafty.keys.SPACE){ // If the key is the spacebar then &quot;flap&quot;
            playerVel = -5; // Sets the player&#x27;s speed and direction to go upwards
        }
    })
    .bind(&quot;HitOn&quot;, function() {
        Crafty.pause();
    })
    .bind(&quot;EnterFrame&quot;, function() {
        Crafty(&quot;Obstacle&quot;).each(function() {
            if(this.x &lt; -objectWidth) {
                this.destroy();
            }
            else {
                this.x -= 3;
            }

        });

        if(obstacleCounter &gt; 100){
            obstacleCounter = 0;
            newObstacle();
        }

        obstacleCounter++;

    });

function newObstacle()
{
    var randomHeight = Math.floor((Math.random() * (sceneHeight/2)) + (sceneHeight/3));
    var bottomOfTopHalf = playAreaHeight - randomHeight;
    var topOfBottomHalf = bottomOfTopHalf + (4 * playerSize);

    // Create the top half of the pipe
    Crafty.e(&quot;Obstacle, 2D, DOM, Color, Solid&quot;)
        .attr({x: sceneWidth,
               y: 0,
               w: objectWidth,
               h: bottomOfTopHalf})
        .color(&quot;#003319&quot;);

    // Create the bottom half of the pipe
    Crafty.e(&quot;Obstacle, 2D, DOM, Color, Solid&quot;)
        .attr({x: sceneWidth,
               y: topOfBottomHalf,
               w: objectWidth,
               h: playAreaHeight - topOfBottomHalf})
        .color(&quot;#003319&quot;);
}
</div>
            </div>
            <div class="flex-container div-half">
                <div class="flex-container">
                    <h2>Preview</h2>
                    <div class="div-content" id="game-container">
                    </div>
                    <h2>Console Log:</h2>
                    <div class="div-content" id="log-div"> </div>
                    <div class="div-content">
                        <h1>Game Lesson Three - Using Game States</h1>
                        <h2 id="part-1-creating-the-start-screen">Part 1: Creating the Start Screen</h2>
<h3 id="goal-defining-a-start-scene-and-a-game-scene">Goal: Defining a start scene and a game scene</h3>
<p>Most games don’t tend to throw you straight into the game once you load it up. What if the player isn’t ready to start playing immediately? This is pretty important for our game, because if you don’t start playing straight away you lose almost instantly!</p>
<p>To get rid of frustrating part of the game we’re going to create a simple start screen.</p>
<p>To create a game state in Crafty we can define a new <code>Scene</code> using <code>Crafty.defineScene</code>. We can give the scene a name and put code inside of the function it runs. </p>
<p>To make our start screen let’s create a scene and call it “Start”:</p>
<pre><code class="lang-javascript">Crafty.defineScene(&quot;Start&quot;, function() {
    // Start screen stuff here :D
});
</code></pre>
<p>We want to place our “Start” scene between our game code and the variables at the top. This is because we want to wrap our game entity code inside of a “Game” scene so that we can switch to and from it.</p>
<p>Before we place anything in the “Start” scene let’s wrap our game code in a new “Game” scene so that we don’t have parts overlapping! The bits we want to have inside are shown in the example below:</p>
<pre><code class="lang-javascript">Crafty.defineScene(&quot;Game&quot;, function() {
    // Our ground goes here

    // Our player goes here

});

// Obstacle function is here!
</code></pre>
<p>Now if you run the code like this you won’t see anything because Crafty hasn’t “entered a scene” - <em>we’re not in any game state at the minute</em>. Now, we need to start the game off by entering the “Start” scene. Crafty can only enter a scene that has been defined above the <code>enterScene()</code> function, which means to load the “Start” scene the enter scene code needs to be like this:</p>
<pre><code class="lang-javascript">Crafty.defineScene(&quot;Start&quot;, function() {
    // Start scene
});

Crafty.enterScene(&quot;Start&quot;);
</code></pre>
<p>With these scenes in place we’re ready to fill our start screen!</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script defer>
        $(document).ready(function() {
    $('#nextLesson, #sectionButton').addClass("lessonComplete");
});

var codeTest = function() {
    return "notest";
}

    </script>
    <!-- Editor (ace) -->

    <script type="text/javascript" src="https://rawgithub.com/craftyjs/Crafty/release/dist/crafty-min.js"></script>
    <script src="https://cdn.jsdelivr.net/ace/1.2.3/min/ace.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/main.js" type="text/javascript" charset="utf-8"></script>
</body>

</html>
